<!DOCTYPE html>
<html lang="en" ng-app="angularJsDemo" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AngularJS Demo - Embedded in Java JAR</title>
    
    <!-- Bootstrap CSS from WebJAR -->
    <link rel="stylesheet" th:href="@{/webjars/bootstrap/5.1.3/css/bootstrap.min.css}">
    
    <style>
        .hero-section {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            padding: 3rem 0;
            border-radius: 0.5rem;
            margin: 1rem 0;
        }
        
        .demo-card {
            background: white;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin: 1rem 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-left: 4px solid #e74c3c;
        }
        
        .angularjs-feature {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 0.375rem;
            padding: 1rem;
            margin: 0.5rem 0;
        }
        
        .framework-comparison {
            background: linear-gradient(45deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            border-radius: 0.5rem;
            margin: 2rem 0;
        }
        
        .live-demo {
            background: #e8f5e8;
            border: 2px solid #28a745;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin: 1rem 0;
        }
        
        .code-example {
            background: #f1f3f4;
            border-radius: 0.25rem;
            padding: 1rem;
            font-family: 'Courier New', monospace;
            margin: 1rem 0;
            overflow-x: auto;
        }
        
        .task-item {
            padding: 0.5rem;
            border-bottom: 1px solid #eee;
            transition: background-color 0.3s;
        }
        
        .task-item:hover {
            background-color: #f8f9fa;
        }
        
        .task-completed {
            text-decoration: line-through;
            color: #6c757d;
            background-color: #e9ecef;
        }
        
        .btn-angularjs {
            background-color: #e74c3c;
            border-color: #e74c3c;
            color: white;
        }
        
        .btn-angularjs:hover {
            background-color: #c0392b;
            border-color: #c0392b;
            color: white;
        }
        
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(231,76,60,.3);
            border-radius: 50%;
            border-top-color: #e74c3c;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .fade-animation.ng-enter {
            transition: 0.5s linear all;
            opacity: 0;
        }
        
        .fade-animation.ng-enter.ng-enter-active {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="container mt-4" ng-controller="MainController as ctrl">
        <!-- Hero Section -->
        <div class="hero-section text-center">
            <h1 class="mb-3">üÖ∞Ô∏è AngularJS Demo</h1>
            <p class="lead">The classic AngularJS 1.8.3 framework embedded in a Java JAR!</p>
            <p class="mb-0">Working alongside React, jQuery, Bootstrap, and Lodash - all self-contained</p>
        </div>

        <!-- Framework Info -->
        <div class="demo-card">
            <h2 class="text-danger mb-3">üìä AngularJS Framework Info</h2>
            <div class="row">
                <div class="col-md-6">
                    <div class="angularjs-feature">
                        <h5><i class="text-danger">üîß</i> Two-Way Data Binding</h5>
                        <p class="mb-0">Model: <strong>{{ctrl.message}}</strong></p>
                        <input type="text" class="form-control mt-2" ng-model="ctrl.message" placeholder="Type here to see two-way binding">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="angularjs-feature">
                        <h5><i class="text-danger">üìù</i> Directives & Filters</h5>
                        <p>Current Time: <strong>{{ctrl.currentTime | date:'medium'}}</strong></p>
                        <p class="mb-0">Uppercase: <strong>{{ctrl.message | uppercase}}</strong></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Live Todo Demo -->
        <div class="live-demo">
            <h3 class="text-success mb-3">‚úÖ Live AngularJS Todo App</h3>
            <div class="row">
                <div class="col-md-8">
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" ng-model="ctrl.newTodo" 
                               placeholder="Add a new todo..." 
                               ng-keypress="$event.which === 13 && ctrl.addTodo()">
                        <button class="btn btn-angularjs" ng-click="ctrl.addTodo()">Add Todo</button>
                    </div>
                    
                    <div class="todo-list" style="max-height: 300px; overflow-y: auto;">
                        <div ng-repeat="todo in ctrl.todos" class="task-item" 
                             ng-class="{'task-completed': todo.completed}">
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="flex-grow-1">
                                    <input type="checkbox" ng-model="todo.completed" class="me-2">
                                    <span ng-bind="todo.text"></span>
                                    <small class="text-muted ms-2" ng-bind="'Added: ' + (todo.created | date:'short')"></small>
                                </div>
                                <button class="btn btn-sm btn-outline-danger" ng-click="ctrl.removeTodo($index)">√ó</button>
                            </div>
                        </div>
                        <div ng-if="ctrl.todos.length === 0" class="text-center text-muted py-3">
                            No todos yet. Add one above!
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="angularjs-feature">
                        <h6>üìà Todo Statistics</h6>
                        <p><strong>Total:</strong> {{ctrl.todos.length}}</p>
                        <p><strong>Completed:</strong> {{ctrl.getCompletedCount()}}</p>
                        <p><strong>Remaining:</strong> {{ctrl.getRemainingCount()}}</p>
                        <div class="progress" style="height: 10px;">
                            <div class="progress-bar bg-success" role="progressbar" 
                                 ng-style="{'width': ctrl.getCompletionPercentage() + '%'}"
                                 aria-valuenow="{{ctrl.getCompletionPercentage()}}" 
                                 aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                        <small class="text-muted">{{ctrl.getCompletionPercentage()}}% Complete</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- AngularJS Features Demo -->
        <div class="demo-card">
            <h3 class="text-danger mb-3">üöÄ AngularJS Features Showcase</h3>
            
            <div class="row">
                <div class="col-md-6">
                    <h5>üîÑ HTTP Service Demo</h5>
                    <button class="btn btn-angularjs me-2" ng-click="ctrl.loadWebJarInfo()" ng-disabled="ctrl.loading">
                        <span ng-if="ctrl.loading" class="spinner me-1"></span>
                        Load WebJAR Info
                    </button>
                    <button class="btn btn-outline-danger" ng-click="ctrl.clearData()">Clear</button>
                    
                    <div ng-if="ctrl.webjarData" class="mt-3">
                        <div class="alert alert-success">
                            <strong>‚úÖ Success!</strong> Loaded info about {{ctrl.getWebJarCount()}} embedded JavaScript libraries
                        </div>
                        <div class="accordion" id="webjarAccordion">
                            <div ng-repeat="(name, info) in ctrl.webjarData.webjars" class="accordion-item">
                                <h2 class="accordion-header" id="heading-{{name}}">
                                    <button class="accordion-button collapsed" type="button" 
                                            data-bs-toggle="collapse" data-bs-target="#collapse-{{name}}">
                                        {{info.name}} v{{info.version}}
                                    </button>
                                </h2>
                                <div id="collapse-{{name}}" class="accordion-collapse collapse" 
                                     data-bs-parent="#webjarAccordion">
                                    <div class="accordion-body">
                                        <p><strong>Description:</strong> {{info.description}}</p>
                                        <p><strong>Main File:</strong> <code>{{info.mainFile}}</code></p>
                                        <div ng-if="info.additionalModules">
                                            <strong>Additional Modules:</strong>
                                            <ul>
                                                <li ng-repeat="(module, path) in info.additionalModules">
                                                    {{module}}: <code>{{path}}</code>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <h5>üéØ Filters & Expressions</h5>
                    <div class="angularjs-feature">
                        <p><strong>Number:</strong> {{ctrl.demoNumber}}</p>
                        <p><strong>Currency:</strong> {{ctrl.demoNumber | currency}}</p>
                        <p><strong>Percentage:</strong> {{ctrl.demoNumber / 100 | percentage}}</p>
                        <input type="range" class="form-range" min="0" max="1000" ng-model="ctrl.demoNumber">
                    </div>
                    
                    <h5 class="mt-3">üé® Conditional Rendering</h5>
                    <div class="angularjs-feature">
                        <button class="btn btn-sm btn-angularjs" ng-click="ctrl.toggleVisible()">
                            {{ctrl.showSecret ? 'Hide' : 'Show'}} Secret
                        </button>
                        <div ng-if="ctrl.showSecret" class="alert alert-info mt-2 fade-animation">
                            <strong>üéâ Secret revealed!</strong> AngularJS is working perfectly inside this JAR!
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Framework Comparison -->
        <div class="framework-comparison text-center">
            <h3 class="mb-4">üèÜ JavaScript Frameworks in This JAR</h3>
            <div class="row">
                <div class="col-md-3">
                    <h5>‚öõÔ∏è React 17</h5>
                    <p>Modern component-based UI</p>
                    <small>Main Application</small>
                </div>
                <div class="col-md-3">
                    <h5>üÖ∞Ô∏è AngularJS 1.8.3</h5>
                    <p>Classic MVC framework</p>
                    <small>This Demo</small>
                </div>
                <div class="col-md-3">
                    <h5>üìö jQuery 3.6.0</h5>
                    <p>DOM manipulation</p>
                    <small>Utility Library</small>
                </div>
                <div class="col-md-3">
                    <h5>üé® Bootstrap 5.1.3</h5>
                    <p>UI Framework</p>
                    <small>Styling</small>
                </div>
            </div>
            <div class="mt-4">
                <p class="lead mb-0">All frameworks coexisting peacefully in a single 84MB JAR! üöÄ</p>
            </div>
        </div>

        <!-- Code Examples -->
        <div class="demo-card">
            <h3 class="text-danger mb-3">üíª AngularJS Code Examples</h3>
            
            <div class="row">
                <div class="col-md-6">
                    <h5>HTML Template</h5>
                    <div class="code-example">
&lt;div ng-controller="MainController as ctrl"&gt;
  &lt;input ng-model="ctrl.message"&gt;
  &lt;p&gt;{{ctrl.message}}&lt;/p&gt;
  
  &lt;div ng-repeat="todo in ctrl.todos"&gt;
    &lt;input type="checkbox" ng-model="todo.completed"&gt;
    {{todo.text}}
  &lt;/div&gt;
&lt;/div&gt;
                    </div>
                </div>
                <div class="col-md-6">
                    <h5>JavaScript Controller</h5>
                    <div class="code-example">
angular.module('angularJsDemo', [])
.controller('MainController', function($http) {
  var vm = this;
  vm.message = 'Hello AngularJS!';
  vm.todos = [];
  
  vm.addTodo = function() {
    if (vm.newTodo) {
      vm.todos.push({
        text: vm.newTodo,
        completed: false,
        created: new Date()
      });
      vm.newTodo = '';
    }
  };
});
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="text-center py-4 mt-5 border-top">
            <div class="row">
                <div class="col-md-4">
                    <h6>üöÄ Performance</h6>
                    <p class="small mb-0">AngularJS loads instantly from embedded WebJAR</p>
                </div>
                <div class="col-md-4">
                    <h6>üîê Security</h6>
                    <p class="small mb-0">No external CDN dependencies required</p>
                </div>
                <div class="col-md-4">
                    <h6>üì¶ Deployment</h6>
                    <p class="small mb-0">Single JAR contains everything</p>
                </div>
            </div>
            <div class="mt-3">
                <a href="/webjars/demo" class="btn btn-outline-primary btn-sm me-2">‚Üê WebJAR Demo</a>
                <a href="/" class="btn btn-outline-primary btn-sm">‚Üê Main App</a>
            </div>
        </footer>
    </div>

    <!-- Load JavaScript libraries from WebJARs -->
    <script th:src="@{/webjars/jquery/3.6.0/jquery.min.js}"></script>
    <script th:src="@{/webjars/bootstrap/5.1.3/js/bootstrap.bundle.min.js}"></script>
    <script th:src="@{/webjars/angularjs/1.8.3/angular.min.js}"></script>
    <script th:src="@{/webjars/angularjs/1.8.3/angular-animate.min.js}"></script>

    <script>
        // AngularJS Application
        angular.module('angularJsDemo', ['ngAnimate'])
        
        .filter('percentage', function() {
            return function(input) {
                return Math.round(input * 100) + '%';
            };
        })
        
        .controller('MainController', ['$http', '$interval', function($http, $interval) {
            var vm = this;
            
            // Initial data
            vm.message = 'Hello from AngularJS embedded in Java JAR! üÖ∞Ô∏è';
            vm.currentTime = new Date();
            vm.demoNumber = 123.45;
            vm.showSecret = false;
            vm.loading = false;
            vm.webjarData = null;
            
            // Todo functionality
            vm.todos = [
                { text: 'Embed AngularJS in Java JAR', completed: true, created: new Date() },
                { text: 'Create interactive demo', completed: true, created: new Date() },
                { text: 'Test two-way data binding', completed: false, created: new Date() },
                { text: 'Showcase AngularJS features', completed: false, created: new Date() }
            ];
            vm.newTodo = '';
            
            // Update time every second
            $interval(function() {
                vm.currentTime = new Date();
            }, 1000);
            
            // Todo methods
            vm.addTodo = function() {
                if (vm.newTodo && vm.newTodo.trim()) {
                    vm.todos.push({
                        text: vm.newTodo.trim(),
                        completed: false,
                        created: new Date()
                    });
                    vm.newTodo = '';
                }
            };
            
            vm.removeTodo = function(index) {
                vm.todos.splice(index, 1);
            };
            
            vm.getCompletedCount = function() {
                return vm.todos.filter(function(todo) { return todo.completed; }).length;
            };
            
            vm.getRemainingCount = function() {
                return vm.todos.filter(function(todo) { return !todo.completed; }).length;
            };
            
            vm.getCompletionPercentage = function() {
                if (vm.todos.length === 0) return 0;
                return Math.round((vm.getCompletedCount() / vm.todos.length) * 100);
            };
            
            // HTTP Demo
            vm.loadWebJarInfo = function() {
                vm.loading = true;
                $http.get('/webjars/info')
                    .then(function(response) {
                        vm.webjarData = response.data;
                        vm.loading = false;
                    })
                    .catch(function(error) {
                        console.error('Error loading WebJAR info:', error);
                        vm.loading = false;
                    });
            };
            
            vm.clearData = function() {
                vm.webjarData = null;
            };
            
            vm.getWebJarCount = function() {
                return vm.webjarData ? Object.keys(vm.webjarData.webjars).length : 0;
            };
            
            // UI methods
            vm.toggleVisible = function() {
                vm.showSecret = !vm.showSecret;
            };
            
            // Show welcome message after page loads
            setTimeout(function() {
                $('#welcome-alert').fadeIn();
            }, 500);
        }]);
        
        // jQuery enhancement for better UX
        $(document).ready(function() {
            // Add success alert
            $('body').prepend(`
                <div id="welcome-alert" class="alert alert-success alert-dismissible fade" role="alert" style="margin: 0; border-radius: 0; display: none;">
                    <strong>üéâ AngularJS Successfully Loaded!</strong> 
                    Framework version 1.8.3 is running from the embedded WebJAR alongside React, jQuery, and Bootstrap.
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            `);
            
            // Enhanced accordion behavior
            $('.accordion-button').on('click', function() {
                console.log('AngularJS + jQuery + Bootstrap working together!');
            });
        });
    </script>
</body>
</html>
